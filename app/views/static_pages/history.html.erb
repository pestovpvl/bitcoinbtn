<div class="card">
  <div class="card-body">
    <h3 class="text-uppercase text-center mt-4">Sell history:</h3>
    <div class="row pb-5">
      <div class="col-12">
        <div class="change__value">
          <span class="badge w-100 badge-success">
            <p class="m-3"> Profit / Lost: </p>
            <p id="historyProfLost" class="change__val m-3"></p>
          </span>
        </div>
      </div>
    </div>
    <div class="row">
      <% @coins.each do |coin| %>
        <!-- *** -->
        <!-- If the coin does not matter in the cost_per_sold field, then it is not sold. And you need to show it here  -->
        <!-- *** -->
        <% if coin.person_id == current_person.id && coin.cost_per_sold %>
          <% if coin.symbol %>
            <% coin.symbol = coin.symbol.upcase %>
              <% end %>
                <% for x in @lookup_coins %>
                  <% if coin.symbol == x["symbol"] %>
                    <div class="col-md-6 wrap__each__coin">
                      <div class="card card-nav-tabs">
                        <h3 class="card-header card-header-primary text-uppercase coin__name">
                          <%= x["name"] %>
                        </h3>
                        <div class="card-body">
                          
                          <!-- END row -->
                          <div class="row static2row mt-2 mb-2">
                            <div class="col-12">
                              <div class="change__value">
                                <span class="badge w-100">
                                  <p class="m-3"> Profit / Lost: </p>
                                  <p class="change__val proit__lost m-3">
                                    <% profit_lost_coin = (coin.cost_per_sold * coin.amount_owned) - (coin.cost_per * coin.amount_owned) %>
                         <%= profit_lost_coin %>
                                  </p>
                                </span>
                              </div>
                            </div>
                          </div>
                          
                          <br>
                          <div class="footer text-center coin__item__wrap">
                            <%= link_to 'Destroy', coin, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger btn-just-icon btn-fill btn-round animated fadeIn" %>
                         
                          </div>
                        </div>
                      </div>
                    </div>

                    <% end %>
                      <% end %>
                        <% end %>
                          <% end %>
                           
    </div> <!-- Close row tag -->
  </div>
</div>
<!-- Close MainCart (Wrap) -->


<script>
  jQuery(document).ready(function ($) {


 // Paste info about portolio value
           var profitLost = 0;
        $('.proit__lost').each(function () {
          profitLost += parseFloat($(this).text());
        });
        console.log(">>>>>" + profitLost);
        $('#historyProfLost').text(profitLost.toFixed(2));

    $(".coin__item__wrap a.btn-info").html('<i class="material-icons">subject</i>');
    $(".coin__item__wrap a.btn-success").html('<i class="material-icons">mode_edit</i>');
    $(".coin__item__wrap a.btn-danger").html('<i class="material-icons">delete</i>');
    $("#cardAddNewCoin a").html('<i class="material-icons">add</i>');
    // Change color depends value
    $(".change__value .badge").each(function () {
      var value = $(this).find(".change__val");
      var value = value.text();
      if (value >= 0) {
        $(this).addClass('badge-success');
      } else {
        $(this).addClass('badge-danger');
        $(this).find(".material-icons").text('trending_down');
      }
    });
    // Change color Summary
    var value = $("#wrapPortfSumm #moneyPortfLost");
    var value = value.text();
    if (value >= 0) {
      $('#wrapPortfSumm').addClass('bg-success');
    } else {
      $('#wrapPortfSumm').addClass('bg-danger');
    }


  });
</script>
